# 목적
이 프로젝트의 목적은 본과 2학년 학생의 CPX(Clinical Performance Examination, 진료수행시험)의 대비이다.

# CPX 진행 순서
1. 시험실 입장 전 기본적인 환자 정보, vital sign, 주호소 확인
2. 시험실 입장 후 10-12분동안 환자 문진 및 신체 진찰
    - 어느 질병인지는 직접 알아내야함
    - 어느 과목의 CASE인지 직접 알아내야함
    - 어느 문진 및 신체 진찰을 진행해야할지 실시간으로 판단해야함
3. 예상되는 진단명 및 필요한 검사, 차후 치료계획을 모의환자에게 설명
4. 시험실 퇴장 후 예상되는 질병 2가지 및 치료계획 4가지를 입력.
5. 다음 시험실로 이동 후 1번부터 반복. 총 3개의 시험실 입장 후 시험 종료

## 시간 배분 권장안
- 병력 청취: 7-8분
- 신체 진찰: 2-3분 (여기까지 10분)
- 진단/검사/치료 설명 + 환자교육: 남은 2분

# 과목별 CASE 목록
현재 data 폴더에 포함된 과목 및 CASE는 다음과 같다.
단, 시험 시 어떤 CASE가 출제될지 사전에 알 수 없으므로, 출력물은 모든 CASE를 통합하여 어떤 상황에서든 대응할 수 있도록 구성한다.

| 과목 | 주호소 (CASE) |
|------|-------------|
| 근골격 | 요통 |
| 생식 및 여성 | 월경이상 |
| 소화기 | 구토 |
| 혈액 및 종양 | 멍이 쉽게 듦 |

data 폴더의 내용이 변경되면 위 표도 함께 갱신할 것.

# 파일 구성
- ./data/(과목명)/*.pdf
- ./data/(과목명)/*.md

## 파일 식별 기준
- **자가채점표**: 파일명에 **"자가채점표"**가 포함된 PDF를 자가채점표로 취급한다. 실제 채점 기준이 되는 체크리스트이므로 **최우선으로 반영할 것.**
- **강의자료**: 자가채점표가 아닌 나머지 PDF는 강의자료로 취급한다. CPX 진행 및 진단을 위해 알아야 할 배경지식으로, 자가채점표를 보충하는 용도로 활용.
- **영상 요약본**: `.md` (Markdown) 파일을 유튜브 강의 영상 요약본으로 취급한다. 강의자료(PDF)와 동일한 역할로, 자가채점표를 보충하는 배경지식으로 활용.

## 데이터 처리 우선순위
1. **자가채점표** — 실제 채점 항목이므로 출력물에 빠짐없이 반영
2. **강의자료 및 영상 요약본** — 자가채점표 항목을 이해하고 보충하는 배경지식으로 활용
3. **강의자료/영상 요약본이 없는 CASE의 경우** — Claude의 의학 지식을 활용하여 자가채점표 항목을 보충한다. 단, 자가채점표의 채점 항목 자체를 임의로 변경하지는 않는다.

# 출력
## 출력 형태
- **모든 CASE를 통합한 단일 출력물** (어떤 CASE를 마주할지 모르므로)
- HTML 정적 웹앱의 형태로 제작
- 파일명: `CPX_(생성일자 YYYYMMDD).html` (예: `CPX_20260209.html`)

## 출력 디자인 가이드라인
- **모바일 반응형** 필수 (시험 전 스마트폰으로 볼 가능성이 높음)
- **탭 구조**: 각 과목 CASE마다 별도 탭으로 분리 + **종합 정리 탭** 1개 추가
- **접기/펼치기** 기능: 각 섹션(카드)을 접고 펼칠 수 있도록
- **체크리스트** 기능: 채점 항목 등을 클릭하여 체크 가능하도록
- 인쇄 지원은 불필요

## 출력 내용 구성
출력물에는 **과목별 CASE마다** 아래 내용을 모두 포함한다:

### 1. 문진 계획 (병력청취)
- 환자에게 실제로 물어볼 질문 목록
- 질문의 순서와 흐름을 **Mermaid.js 등을 활용한 시각적 순서도**로 표현
- 환자 답변에 따른 분기 (감별진단 로직)를 순서도에 포함
- 각 질문이 어떤 감별을 위한 것인지 표시

#### Mermaid.js 작성 규칙 (v10 호환)
Mermaid v10에서 아래 패턴은 "Syntax error in text" 파싱 에러를 유발하므로 반드시 준수할 것:
1. **`graph TD` 사용** — `flowchart TD` 대신 `graph TD`를 사용 (파서 호환성)
2. **`<br>` 사용** — `<br/>` (self-closing) 금지. 슬래시(`/`)가 Mermaid 도형 구분자로 오인됨
3. **`{}` 다이아몬드 노드 금지** — `G{"텍스트"}` 형태는 특수문자와 충돌 가능. 모든 노드는 `["텍스트"]` 사각형으로 통일
4. **노드 라벨 내 특수문자 최소화** — `/`, `↓`, `↑`, `→`, `(`, `)` 등을 피하고, 공백이나 한글 대체어로 치환 (예: `감각↓` → `감각저하`, `A/B` → `A B`)
5. **edge label(`|...|`) 내 특수문자 금지** — `|감각/근력|` → `|감각 근력|`, `|30분↑|` → `|30분 이상|`, `|A+B|` → `|A B|`
6. **숨겨진 탭(display:none) 렌더링 처리** — `startOnLoad: false`로 설정 후, 페이지 로드 시 모든 탭을 잠시 표시하여 렌더링한 뒤 원래 상태로 복원. 탭 전환 시에도 미렌더링 다이어그램을 감지하여 `mermaid.run()` 호출

### 2. 신체진찰 계획
- 수행해야 할 신체진찰 항목 및 순서
- 각 진찰의 목적 (어떤 질환을 감별하기 위한 것인지)

### 3. 감별진단 및 검사/치료계획
- 예상 감별진단(DDx): 자가채점표에 나열된 DDx는 **모두 포함**하되, 시험 현장에서 실제로 좁혀나갈 **주요 2-3개를 강조 표시**
- 각 진단에 따른 필요 검사
- 치료계획 (시험 후 입력용 4가지 포함)

### 4. 환자 설명 및 교육
- 모의환자에게 진단/검사/치료를 설명하는 멘트
- 환자교육 내용

### 5. 채점 및 평가 관련 항목
- 자가채점표에 명시된 채점 항목은 **반드시 빠짐없이** 출력물에 반영할 것
- CPX 공통 평가 영역(병력청취, 신체진찰, 환자-의사 관계, 환자교육 등)의 구체적인 내용과 기준은 **해당 회차 자가채점표의 내용을 기반으로 Claude가 판단**하여 반영한다
  - 매년 채점 기준이 달라질 수 있으므로, CLAUDE.md에 고정된 기준을 두지 않고 자가채점표 데이터에 의존한다

### 6. 의사소통 / 환자-의사 관계 (공통)
- 의사소통/환자-의사 관계 항목은 **모든 CASE에 공통으로** 포함한다
- 자가채점표에 구체적 항목이 있으면 해당 내용을 우선 반영하고, 없더라도 기본 의사소통 원칙(open question, 공감, 경청, 요약)을 포함한다

# CASE 업데이트
- data 폴더의 내용이 변경(추가/삭제/수정)되면, 기존 출력물을 대체하는 새 통합 출력물을 재생성한다.
- CASE 목록 테이블도 data 폴더 내용에 맞춰 갱신한다.

# 파일 생성 규칙
## 파일 생성 스크립트
- Claude가 직접 HTML을 작성하는 경우 scripts 폴더는 불필요
- 별도 빌드/변환 스크립트(예: Python으로 HTML→docx 변환 등)가 필요한 경우에만 ./scripts 폴더에 저장할 것

## 출력
생성된 결과물이나 출력은 ./outputs 폴더에 저장할 것

# 배포 (GitHub Pages)

## 리포지토리 정보
- GitHub: https://github.com/waterple/CPX_Study
- Pages URL: https://waterple.github.io/CPX_Study/
- 브랜치: `main`, Pages 소스: `/` (루트)

## 디렉토리 구조
```
CPX_Study/
├── index.html              ← 정리본 목록 페이지 (루트)
├── YYYY-MM-DD/
│   └── index.html          ← 해당 날짜의 정리본
├── outputs/
│   └── CPX_YYYYMMDD.html   ← 원본 출력물 보관
├── data/                   ← .gitignore 제외 (강의자료 원본)
├── CLAUDE.md
└── .gitignore
```

## 새 정리본 추가 시 작업 순서
1. `data/` 폴더에 새 자료를 추가하거나 기존 자료를 수정한다
2. 정리본을 생성하여 `outputs/CPX_YYYYMMDD.html`로 저장한다
3. `YYYY-MM-DD/index.html`에 동일 파일을 복사한다
4. 루트 `index.html`의 목록에 새 날짜 항목을 추가한다
5. 변경 파일을 커밋하고 `main` 브랜치에 푸시한다

## Git 규칙
- **커밋 전 확인**: `data/` 폴더가 `.gitignore`에 의해 제외되고 있는지 반드시 확인할 것 (강의자료 저작권 보호)
- **커밋 단위**: 정리본 추가/수정 시 관련 파일(`YYYY-MM-DD/index.html`, `outputs/CPX_YYYYMMDD.html`, `index.html`)을 한 커밋으로 묶는다
- **커밋 메시지 형식**: `YYYY-MM-DD 정리본 추가` 또는 `YYYY-MM-DD 정리본 수정: (변경 내용)`
- **푸시**: 커밋 후 `git push origin main`으로 푸시하면 GitHub Pages가 자동 배포된다
- **강제 푸시 금지**: `git push --force` 사용 금지
